{% extends '../base_in.html' %}
{% block titulo %}
    Prestamo de Equipo
{% endblock titulo %}

{% block l3 %}
    active
{% endblock l3 %}

{% block cuerpo %}
<div class="card text-center">
    <div class="card-header">
        <ul class="nav nav-tabs card-header-tabs">
            <li class="nav-item" >
                <a class="nav-link {{ clases.o1 }}" href="{% url 'prestamos:crear_prestamo-url' %}">Gestión de prestamos</a>
            </li>
            <li class="nav-item">
            <a class="nav-link {{ clases.o2 }}" href="">Prestamos</a>
            </li>
            <li class="nav-item">
            <a class="nav-link {{ clases.o3 }} " href="">...</a>
            </li>
            <li class="nav-item">
            <a class="nav-link {{ clases.o3 }}" href="#">...</a>
            </li>
        </ul>
    </div>
    <div class="card-body">
       <div style="{{estilos.o1}}">
                {% if messages %}
                {% for message in messages %}
                    <span class="alert alert-danger alert-dismissible ">Error: {{ message|escape }}</span> <!--data-dismiss="alert"-->
                    <br><br>
                {% endfor %}
                {% endif %}

                <form method="post" id="formPrestamo">
                        <input type="hidden" name="crear" id="crear" value="{{ crear }}">
                        {% csrf_token %}
                        <div class="row container border">
                                <br>
                                <br>
                                <div class="form-group col-md-3">
                                        <label>Numero</label>
                                        {{prestamo_form.numPrestamo}}                                                          
                                </div>
                                <br>
                                <br>
                                <div class="form-group col-md-4">
                                        <label>Empresa</label>
                                        {{prestamo_form.compania}}                                                          
                                </div>

                                {{ detallePrestamo_formset.management_form }}
                                <hr>
                                <table class="table table-striped table-inverse table-responsive">
                                        <thead class="thead-inverse">
                                                <tr>
                                                        <th>Equipo</th>
                                                        <th>Tapadera</th>
                                                        <th>Descripción</th>
                                                        <th>Accion</th>
                                                </tr>     
                                        </thead>
                                        <tbody>  
                                        {% for dp in detallePrestamo_formset %}
                                                <tr class="detalle-formset">
                                                        
                                                        <td>{{dp.equipo}}</td>
                                                        <td>{{dp.tapadera}}</td>
                                                        <td>{{dp.descripcion}}</td>
                                                        <td></td>
                                                </tr>    
                                        {% endfor %}                   
                                        </tbody>
                                </table>

                                <div class="form-group col-md-3">
                                        <label>Numero de placa</label>
                                        {{prestamo_form.placa}}                                                          
                                </div>
                                <div class="form-group col-md-3">
                                        <label>Hora de salida</label>
                                        {{prestamo_form.horaSalida}}                                                          
                                </div>
                                <div class="form-group col-md-3">
                                        <label>Fecha de salida</label>
                                        {{prestamo_form.fechaSalida}}                                                          
                                </div>
                                <div class="form-group col-md-3 alert-info">
                                        <label>Fecha de Entrada</label>
                                        {{prestamo_form.fechaEntrada}}     
                                        <br>                                                     
                                </div>
                                <div class="form-group col-md-6">
                                        <label>Conductor</label>
                                        {{prestamo_form.conductor}}  
                                </div>
                                <div class="form-group col-md-6">
                                        <label>Entrego</label>
                                        {{prestamo_form.empleado}}  
                                </div>
                                <div class="form-group col-md-12">
                                        <label>Observaciones</label>
                                        {{prestamo_form.observaciones}}  
                                </div>
                        </div>
                        <br>
                        <a href="{% url 'prestamos:prestamos-url'%} " class="btn btn-secondary">Cancelar</a>
                        <input type="submit" class="btn btn-success" value="Guardar" class="button" />
                        
                </form>
       </div>
       <div style="{{estilos.o2}}">
               <table id="tablajs" class="table table-striped table-bordered ">
                       <thead class="thead-inverse">
                               <tr>
                                       <th>#</th>
                                       <th>Compañia</th>
                                       <th>Vehiculo</th>
                                       <th>Hora de Salida</th>
                                       <th>Fecha de Salida</th>
                                       <th>Fecha de entrada</th>
                                       <th>Conductor</th>
                                       <th>Empleado</th>
                                       <th>Estado</th>
                                       <th>Acciones</th>
                               </tr>
                               </thead>
                               <tbody>
                                        {% for p in prestamos  %}
                                       <tr {% if p.estadoPrestamo.id == 1 %}
                                                
                                        {% elif p.estadoPrestamo.id == 2 %}
                                                class="table-danger"
                                        {% elif p.estadoPrestamo.id == 3 %}
                                               class="table-info"
                                        {% elif p.estadoPrestamo.id == 4 %}
                                                class="table-success" 
                                        {% endif %}>
                                               <td scope="row">{{p.numPrestamo}}</td>
                                               <td>{{p.compania}}</td>
                                               <td>{{p.placa}}</td>
                                               <td>{{p.horaSalida}}</td>
                                               <td>{{p.fechaSalida}}</td>
                                               <td>
                                               {% if p.fechaEntrada %}
                                                       {{p.fechaEntrada}}
                                                {% else %}
                                                        -
                                               {% endif %}
                                                       </td>
                                               <td>{{p.conductor}}</td>
                                               <td>{{p.empleado}}</td>
                                               <td>
                                                
                                                {% if p.estadoPrestamo.id == 1 %}
                                                        <p style="display: none">1</p>
                                                        <i class="fas fa-exclamation" ></i>
                                                {% elif p.estadoPrestamo.id == 2 %}
                                                        <p style="display: none">2</p>
                                                        <i class="fas fa-times"></i>
                                                {% elif p.estadoPrestamo.id == 3 %}
                                                        <p style="display: none">3</p>
                                                        <i class="fas fa-asterisk"></i>
                                                {% elif p.estadoPrestamo.id == 4 %}
                                                        <p style="display: none">4</p>
                                                        <i class="fas fa-check"></i>
                                                {% endif %}
                                                        
                                               </td>
                                               <td>
                                                {% if p.estadoPrestamo.id == 1 %}
                                                        <button class="btn btn-success fas fa-check"></button>
                                                        <button data-editar="{{p.numPrestamo}}" class="editar btn btn-info fas fa-pen"></button>
                                                        <button class="btn btn-danger fas fa-times"></button>
                                                        <button class="btn btn-warning fas fa-eye "></button>
                                                {% elif p.estadoPrestamo.id == 2 %}
                                                {% elif p.estadoPrestamo.id == 3 %}
                                                {% elif p.estadoPrestamo.id == 4 %}
                                                {% endif %}
                                                       
                                                       
                                                       
                                               </td>
                                       </tr>
                                       {% endfor %}
                               </tbody>
               </table>
       </div>
    </div>
        
</div>
{% endblock cuerpo %}
{% load static %}
{% block script %}
    <script src="{% static 'js/prestamos.js'%}"></script>
{% endblock script %}
    
    
